services:
  - type: web
    name: marvel-app
    runtime: docker
    dockerfilePath: ./vendor/laravel/sail/runtimes/8.1/Dockerfile
    dockerContext: .
    buildCommand: |
      docker build -t marvel-app \
        --build-arg WWWGROUP=1000 \
        --build-arg WWWUSER=1000 \
        -f ./vendor/laravel/sail/runtimes/8.1/Dockerfile .
    startCommand: php artisan serve --host=0.0.0.0 --port=8000
    envVars:
      - key: WWWUSER
        value: 1000
      - key: LARAVEL_SAIL
        value: 1
      - key: APP_PORT
        value: 8000
      # [Include all your other environment variables from previous config]
      - key: APP_NAME
        value: Marvel
      - key: APP_ENV
        value: production
      # ... (rest of your environment variables)

  - type: pserv
    name: mysql
    runtime: docker
    image: mysql:8.0
    envVars:
      - key: MYSQL_ROOT_PASSWORD
        generateValue: true
      - key: MYSQL_DATABASE
        value: marvel_laravel
      - key: MYSQL_USER
        value: marvel_user
      - key: MYSQL_PASSWORD
        generateValue: true
    disk:
      name: mysql_data
      mountPath: /var/lib/mysql
      sizeGB: 10

  - type: pserv
    name: redis
    runtime: docker
    image: redis:alpine
    disk:
      name: redis_data
      mountPath: /data
      sizeGB: 1

  - type: pserv
    name: mailhog
    runtime: docker
    image: mailhog/mailhog:latest
    port: 8025
